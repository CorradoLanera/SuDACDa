<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Survival Data Analysis for Cancer Data</title>
  <meta name="description" content="Examples and exercise from the Politecnico Ph.D. course by prof. Sylvie Chevret and prof. Matthieu Resche-Rigon.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Survival Data Analysis for Cancer Data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://corradolanera.github.io/SuDACDa/" />
  
  <meta property="og:description" content="Examples and exercise from the Politecnico Ph.D. course by prof. Sylvie Chevret and prof. Matthieu Resche-Rigon." />
  <meta name="github-repo" content="CorradoLanera/SuDACDa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Survival Data Analysis for Cancer Data" />
  
  <meta name="twitter:description" content="Examples and exercise from the Politecnico Ph.D. course by prof. Sylvie Chevret and prof. Matthieu Resche-Rigon." />
  

<meta name="author" content="Corrado Lanera, Danila Azzolina, Daniele Bottigliengo">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="cox.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Survival Data Analysis for Cancer Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributions"><i class="fa fa-check"></i>Contributions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#settings"><i class="fa fa-check"></i>Settings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="survival.html"><a href="survival.html"><i class="fa fa-check"></i><b>1</b> <em>Monday</em>: Introduction to Survival Analyses and simulation of data</a><ul>
<li class="chapter" data-level="1.1" data-path="survival.html"><a href="survival.html#key1"><i class="fa fa-check"></i><b>1.1</b> Key (operative) concepts</a></li>
<li class="chapter" data-level="1.2" data-path="survival.html"><a href="survival.html#sumulation1"><i class="fa fa-check"></i><b>1.2</b> Simulated Data</a></li>
<li class="chapter" data-level="1.3" data-path="survival.html"><a href="survival.html#mgus"><i class="fa fa-check"></i><b>1.3</b> <code>mgus</code> data from <strong>survival</strong> package</a></li>
<li class="chapter" data-level="1.4" data-path="survival.html"><a href="survival.html#km1"><i class="fa fa-check"></i><b>1.4</b> Non parametric Kaplan-Meier estimation of the survival function</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i><b>2</b> <em>Tuesday</em>: Cox models</a><ul>
<li class="chapter" data-level="2.1" data-path="cox.html"><a href="cox.html#key2"><i class="fa fa-check"></i><b>2.1</b> Key (operative) concepts</a></li>
<li class="chapter" data-level="2.2" data-path="cox.html"><a href="cox.html#test2"><i class="fa fa-check"></i><b>2.2</b> Basic tests and funtions</a><ul>
<li class="chapter" data-level="2.2.1" data-path="cox.html"><a href="cox.html#impact-of-sex-on-death-sex2"><i class="fa fa-check"></i><b>2.2.1</b> Impact of sex on death {sex2}</a></li>
<li class="chapter" data-level="2.2.2" data-path="cox.html"><a href="cox.html#age2"><i class="fa fa-check"></i><b>2.2.2</b> Impact of age on death</a></li>
<li class="chapter" data-level="2.2.3" data-path="cox.html"><a href="cox.html#ast2"><i class="fa fa-check"></i><b>2.2.3</b> Impact of aspartate aminotransferase (<code>ast</code>) on death</a></li>
<li class="chapter" data-level="2.2.4" data-path="cox.html"><a href="cox.html#platelet2"><i class="fa fa-check"></i><b>2.2.4</b> Impact of <strong>platelet</strong> on death</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cox.html"><a href="cox.html#adjusted2"><i class="fa fa-check"></i><b>2.3</b> Investigation on adjusted variables and interactions</a></li>
<li class="chapter" data-level="2.4" data-path="cox.html"><a href="cox.html#longitudinal"><i class="fa fa-check"></i><b>2.4</b> Longitudinal suvival data analayses</a><ul>
<li class="chapter" data-level="2.4.1" data-path="cox.html"><a href="cox.html#bilurubine2"><i class="fa fa-check"></i><b>2.4.1</b> Impact of bilurubine of death</a></li>
<li class="chapter" data-level="2.4.2" data-path="cox.html"><a href="cox.html#ast_full2"><i class="fa fa-check"></i><b>2.4.2</b> Impact of ast</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="cox.html"><a href="cox.html#prognostic2"><i class="fa fa-check"></i><b>2.5</b> Prognostic model</a><ul>
<li class="chapter" data-level="2.5.1" data-path="cox.html"><a href="cox.html#prognostic-model-w-ascites-edema-sex-bili-ast-platelet-stage"><i class="fa fa-check"></i><b>2.5.1</b> prognostic model w/ <code>àscites</code>, <code>edema</code>, <code>sex</code>, <code>bili</code>, <code>ast</code>, <code>platelet</code>, <code id="model2">stage</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="competing-risk.html"><a href="competing-risk.html"><i class="fa fa-check"></i><b>3</b> <em>Wednesday</em>: Competing risk</a><ul>
<li class="chapter" data-level="3.1" data-path="competing-risk.html"><a href="competing-risk.html#key3"><i class="fa fa-check"></i><b>3.1</b> Key (operative) concepts</a></li>
<li class="chapter" data-level="3.2" data-path="competing-risk.html"><a href="competing-risk.html#data-manipulation"><i class="fa fa-check"></i><b>3.2</b> Data manipulation</a></li>
<li class="chapter" data-level="3.3" data-path="competing-risk.html"><a href="competing-risk.html#simulation-of-competing-risk"><i class="fa fa-check"></i><b>3.3</b> Simulation of Competing risk</a></li>
<li class="chapter" data-level="3.4" data-path="competing-risk.html"><a href="competing-risk.html#estimation-of-the-effect-of-sex-on-mgus-incidence"><i class="fa fa-check"></i><b>3.4</b> Estimation of the effect of sex on MGUS incidence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i>Software</a><ul>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html#system-information"><i class="fa fa-check"></i>System Information</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/CorradoLanera/SuDACDa" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Survival Data Analysis for Cancer Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="survival" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> <em>Monday</em>: Introduction to Survival Analyses and simulation of data</h1>
<div id="key1" class="section level2">
<h2><span class="header-section-number">1.1</span> Key (operative) concepts</h2>
<ol style="list-style-type: decimal">
<li>Time has asymmetric density and can be censored:</li>
</ol>
<ul>
<li>not possible to summarize it by the means</li>
<li>cannot be normal distributed</li>
<li>use exponential family</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Plot the log-plot to check the distribution assumptions</p></li>
<li>Censoring can be:</li>
</ol>
<ul>
<li>Right: event not (yet) occurred at f-up
<ul>
<li>Fixed (identical f-up for anyone)</li>
<li>Sequential (<span class="math inline">\(min(T_i, C_i)\)</span>)</li>
<li>Random</li>
</ul></li>
<li>Left: the event has occurred before the observed period (all population but not all information, e.g. menarche date)</li>
<li>Interval: the event can be occurred between two times (but don’t know when)</li>
<li>Left truncated: starting point is after the beginning (different from Left, all the information but not complete population)</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Models:</li>
</ol>
<ul>
<li>statistical: non-informative censoring (Kaplan-Meier, Cox model, …)</li>
<li>probabilistic: independent censoring (life tables)</li>
<li>parametric (<code>survival::survreg()</code>, need to define the distribution) VS non-parametric (<code>survival::survfit()</code> or <code>rms::npsurv()</code>, no need to define distribution)</li>
</ul>
</div>
<div id="sumulation1" class="section level2">
<h2><span class="header-section-number">1.2</span> Simulated Data</h2>
<ol style="list-style-type: decimal">
<li>Simulate a sample of <span class="math inline">\(n = 100\)</span> or <span class="math inline">\(1000\)</span> exponential survival times, w/ mean <span class="math inline">\(\theta = 5\)</span>.</li>
</ol>
<ul>
<li>Non censored</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">171002</span>)
n              &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">thousand =</span> <span class="dv">1000</span>)                                   <span class="co"># samples</span>
t              &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">5</span>)                   <span class="co"># random exponential times</span>
status_no_cens &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> n)         <span class="co"># no censored data --&gt; all are cases</span></code></pre></div>
<ul>
<li>Uniform censoring over <span class="math inline">\([0, a]\)</span>, w/ <span class="math inline">\(a = 1, a = 0.5\)</span> or <span class="math inline">\(a = 2\)</span></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a              &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">cens_05 =</span> <span class="fl">0.5</span>)   <span class="co"># upper bound of the uniform censoring dist</span>
cens           &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> a)                    <span class="co"># censored times</span>
t_cens         &lt;-<span class="st"> </span><span class="kw">pmin</span>(t, cens)    <span class="co"># censored times are earlier than event times</span>
status_cens    &lt;-<span class="st"> </span>status_no_cens -<span class="st"> </span>(t_cens ==<span class="st"> </span>cens)      <span class="co"># remove censored cases</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Plot the observed survival times</li>
</ol>
<ul>
<li>Non censored and censored</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># NOTE: for the plots to be comparable, xlim and ylim have to be the same range</span>
<span class="co">#       for both the plots. Moreover to drow well adjusted plots, they were set</span>
<span class="co">#       a posteriori.</span>
<span class="kw">hist</span>(t,
  <span class="dt">main =</span> <span class="st">&#39;Hystogram of uncensored times&#39;</span>,
  <span class="dt">col  =</span> <span class="st">&#39;green&#39;</span>,
  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>),
  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">400</span>),
  <span class="dt">labels =</span> <span class="ot">TRUE</span>                        <span class="co"># add the labels over the top of the bars</span>
)
<span class="kw">hist</span>(t_cens,
  <span class="dt">main =</span> <span class="st">&#39;Hystogram of censored times (a = 0.5)&#39;</span>,
  <span class="dt">col  =</span> <span class="st">&#39;red&#39;</span>,
  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>),
  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">400</span>),
  <span class="dt">labels =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/sim_plots-1.png" width="50%" /><img src="SuDACDa-notes_files/figure-html/sim_plots-2.png" width="50%" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Parametric estimation of survival function</li>
</ol>
<ul>
<li>Uncensored</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># `?survreg` := &quot;Regression for a Parametric Survival Model&quot;</span>
<span class="co"># </span>
<span class="co"># R formula: y ~ x &lt;--&gt; math formula: y = f(x)</span>
<span class="co"># </span>
<span class="co"># Here we want to model the response (labelled time) as they are, w/out any</span>
<span class="co"># furter investigation on the effect on them from some other variable</span>
<span class="kw">survreg</span>(<span class="kw">Surv</span>(t, status_no_cens) ~<span class="st"> </span><span class="dv">1</span>,
  <span class="dt">dist =</span> <span class="st">&#39;exponential&#39;</span>
) %&gt;%
<span class="st">  </span>summary     <span class="co"># here `summary()` add some more statistics to the standard output</span></code></pre></div>
<pre><code>## 
## Call:
## survreg(formula = Surv(t, status_no_cens) ~ 1, dist = &quot;exponential&quot;)
##             Value Std. Error     z p
## (Intercept) -1.58     0.0316 -50.1 0
## 
## Scale fixed at 1 
## 
## Exponential distribution
## Loglik(model)= 584.3   Loglik(intercept only)= 584.3
## Number of Newton-Raphson Iterations: 4 
## n= 1000</code></pre>
<ul>
<li>Censored</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">survreg</span>(<span class="kw">Surv</span>(t_cens, status_cens) ~<span class="st"> </span><span class="dv">1</span>,
  <span class="dt">dist =</span> <span class="st">&#39;exponential&#39;</span>
) %&gt;%
<span class="st">  </span>summary</code></pre></div>
<pre><code>## 
## Call:
## survreg(formula = Surv(t_cens, status_cens) ~ 1, dist = &quot;exponential&quot;)
##             Value Std. Error     z p
## (Intercept) -1.57     0.0401 -39.2 0
## 
## Scale fixed at 1 
## 
## Exponential distribution
## Loglik(model)= 355.9   Loglik(intercept only)= 355.9
## Number of Newton-Raphson Iterations: 4 
## n= 1000</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Non parametric estimation of survival and the distribution functions</li>
</ol>
<ul>
<li>Uncensored</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># `?survfit` := &quot;Create survival curves&quot;</span>
<span class="kw">survfit</span>(<span class="kw">Surv</span>(t, status_no_cens) ~<span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## Call: survfit(formula = Surv(t, status_no_cens) ~ 1)
## 
##        n   events   median  0.95LCL  0.95UCL 
## 1000.000 1000.000    0.140    0.128    0.158</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Here we would like to compare to approach to survival plots:</span>
<span class="co"># 1. Using the packege _survival_, so the standard one</span>
<span class="co"># 2. Uisng the package _rms_, a comprehensive package for regression analyses</span>

<span class="co"># Using survival `plot` provided by the _survival_ package</span>
<span class="co"># (`?survival:::plot.survfit`), we can continue to</span>
<span class="co"># use the `survfit()` function for nonparametric survival estimation from the</span>
<span class="co"># same _survival_ package</span>
<span class="kw">survfit</span>(<span class="kw">Surv</span>(t, status_no_cens) ~<span class="st"> </span><span class="dv">1</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">plot</span>(
    <span class="dt">xlim     =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.55</span>),
    <span class="dt">conf.int  =</span> <span class="ot">TRUE</span>,
    <span class="dt">mark.time =</span> <span class="ot">TRUE</span>,
    <span class="dt">col       =</span> <span class="st">&#39;green&#39;</span>,
    <span class="dt">main      =</span> <span class="st">&#39;Uncensored --- survival&#39;</span>
)


<span class="co"># Using the survplot from the _rms_ package (`survplot`), we have to switch to</span>
<span class="co"># the `npsurv()` function for nonparametric survival estimation from the _rms_</span>
<span class="co"># package</span>
<span class="kw">npsurv</span>(<span class="kw">Surv</span>(t, status_no_cens) ~<span class="st"> </span><span class="dv">1</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">survplot</span>(
    <span class="dt">xlim     =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>),
    <span class="dt">conf.int =</span> <span class="ot">TRUE</span>,
    <span class="dt">n.risk   =</span> <span class="ot">TRUE</span>,
    <span class="dt">col      =</span> <span class="st">&#39;green&#39;</span>
)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&#39;Uncensored --- rms&#39;</span>) <span class="co"># unfortunally survplot do not have an</span>
                                   <span class="co"># integrated option for the title...</span></code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/survfit_nocens-1.png" width="672" /><img src="SuDACDa-notes_files/figure-html/survfit_nocens-2.png" width="672" /></p>
<ul>
<li>censored</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">survfit</span>(<span class="kw">Surv</span>(t_cens, status_cens) ~<span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## Call: survfit(formula = Surv(t_cens, status_cens) ~ 1)
## 
##        n   events   median  0.95LCL  0.95UCL 
## 1000.000  623.000    0.141    0.130    0.158</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">survfit</span>(<span class="kw">Surv</span>(t_cens, status_cens) ~<span class="st"> </span><span class="dv">1</span>) %&gt;%
<span class="st">  </span><span class="kw">plot</span>(
    <span class="dt">xlim     =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.55</span>),
    <span class="dt">conf.int  =</span> <span class="ot">TRUE</span>,
    <span class="dt">mark.time =</span> <span class="ot">TRUE</span>,
    <span class="dt">col      =</span> <span class="st">&#39;red&#39;</span>,
    <span class="dt">main      =</span> <span class="st">&#39;Censored (a = 0.5)&#39;</span>
)

<span class="kw">npsurv</span>(<span class="kw">Surv</span>(t_cens, status_cens) ~<span class="st"> </span><span class="dv">1</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">survplot</span>(
    <span class="dt">xlim     =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),
    <span class="dt">conf.int =</span> <span class="ot">TRUE</span>,
    <span class="dt">n.risk   =</span> <span class="ot">TRUE</span>,
    <span class="dt">col      =</span> <span class="st">&#39;red&#39;</span>
)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&#39;Censored (a = 0.5) --- rms&#39;</span>)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/survfit_cens-1.png" width="672" /><img src="SuDACDa-notes_files/figure-html/survfit_cens-2.png" width="672" /></p>
</div>
<div id="mgus" class="section level2">
<h2><span class="header-section-number">1.3</span> <code>mgus</code> data from <strong>survival</strong> package</h2>
<ol style="list-style-type: decimal">
<li>Load and explore data</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(mgus)                                                                <span class="co"># load</span>
<span class="kw">head</span>(mgus)                                                       <span class="co"># first 10 rows</span></code></pre></div>
<pre><code>##   id age    sex dxyr pcdx pctime futime death alb creat  hgb mspike
## 1  1  78 female   68 &lt;NA&gt;     NA    748     1 2.8   1.2 11.5    2.0
## 2  2  73 female   66   LP   1310   6751     1  NA    NA   NA    1.3
## 3  3  87   male   68 &lt;NA&gt;     NA    277     1 2.2   1.1 11.2    1.3
## 4  4  86   male   69 &lt;NA&gt;     NA   1815     1 2.8   1.3 15.3    1.8
## 5  5  74 female   68 &lt;NA&gt;     NA   2587     1 3.0   0.8  9.8    1.4
## 6  6  81   male   68 &lt;NA&gt;     NA    563     1 2.9   0.9 11.5    1.8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(mgus)                                              <span class="co"># number of rows and cols</span></code></pre></div>
<pre><code>## [1] 241  12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(mgus)                                                <span class="co"># name of the columns</span></code></pre></div>
<pre><code>##  [1] &quot;id&quot;     &quot;age&quot;    &quot;sex&quot;    &quot;dxyr&quot;   &quot;pcdx&quot;   &quot;pctime&quot; &quot;futime&quot;
##  [8] &quot;death&quot;  &quot;alb&quot;    &quot;creat&quot;  &quot;hgb&quot;    &quot;mspike&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(mgus)                                   <span class="co"># R internal structure of the object</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    241 obs. of  12 variables:
##  $ id    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ age   : atomic  78 73 87 86 74 81 72 79 85 58 ...
##   ..- attr(*, &quot;label&quot;)= chr &quot;AGE AT date_on&quot;
##  $ sex   : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 1 2 2 1 2 1 1 1 2 ...
##   ..- attr(*, &quot;label&quot;)= chr &quot;Sex&quot;
##  $ dxyr  : num  68 66 68 69 68 68 68 69 70 65 ...
##  $ pcdx  : Factor w/ 4 levels &quot;AM&quot;,&quot;LP&quot;,&quot;MA&quot;,..: NA 2 NA NA NA NA NA NA NA NA ...
##  $ pctime: atomic  NA 1310 NA NA NA NA NA NA NA NA ...
##   ..- attr(*, &quot;label&quot;)= chr &quot;Progression to Group 4 (days)&quot;
##  $ futime: atomic  748 6751 277 1815 2587 ...
##   ..- attr(*, &quot;label&quot;)= chr &quot;Follow-Up Time&quot;
##  $ death : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ alb   : atomic  2.8 NA 2.2 2.8 3 2.9 3 3.1 3.2 3.5 ...
##   ..- attr(*, &quot;label&quot;)= chr &quot;Serum Albumin&quot;
##  $ creat : atomic  1.2 NA 1.1 1.3 0.8 0.9 0.8 0.8 1 1 ...
##   ..- attr(*, &quot;label&quot;)= chr &quot;Serum Creatinine&quot;
##  $ hgb   : atomic  11.5 NA 11.2 15.3 9.8 11.5 13.5 15.5 12.4 14.8 ...
##   ..- attr(*, &quot;label&quot;)= chr &quot;Hemoglobin&quot;
##  $ mspike: atomic  2 1.3 1.3 1.8 1.4 1.8 1.3 1.4 1.5 2.2 ...
##   ..- attr(*, &quot;label&quot;)= chr &quot;Serum M-Spike&quot;
##  - attr(*, &quot;formats&quot;)=List of 1
##   ..$ death:List of 2
##   .. ..$ values: num  0 1
##   .. ..$ labels: chr  &quot;Alive&quot; &quot;Dead&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mgus)                                              <span class="co"># summary from base R</span></code></pre></div>
<pre><code>##        id           age            sex           dxyr        pcdx    
##  Min.   :  1   Min.   :34.00   female:104   Min.   :56.0   AM  :  8  
##  1st Qu.: 61   1st Qu.:55.00   male  :137   1st Qu.:66.0   LP  :  5  
##  Median :121   Median :63.00                Median :68.0   MA  :  7  
##  Mean   :121   Mean   :62.87                Mean   :67.4   MM  : 44  
##  3rd Qu.:181   3rd Qu.:72.00                3rd Qu.:70.0   NA&#39;s:177  
##  Max.   :241   Max.   :90.00                Max.   :73.0             
##                                                                      
##      pctime          futime          death             alb       
##  Min.   :  365   Min.   :    6   Min.   :0.0000   Min.   :1.800  
##  1st Qu.: 2469   1st Qu.: 2422   1st Qu.:1.0000   1st Qu.:2.900  
##  Median : 3778   Median : 5022   Median :1.0000   Median :3.200  
##  Mean   : 4342   Mean   : 5425   Mean   :0.9336   Mean   :3.204  
##  3rd Qu.: 5750   3rd Qu.: 8264   3rd Qu.:1.0000   3rd Qu.:3.500  
##  Max.   :11685   Max.   :14325   Max.   :1.0000   Max.   :5.100  
##  NA&#39;s   :177                                      NA&#39;s   :31     
##      creat            hgb            mspike     
##  Min.   :0.600   Min.   : 7.40   Min.   :0.300  
##  1st Qu.:0.900   1st Qu.:12.20   1st Qu.:1.500  
##  Median :1.000   Median :13.20   Median :1.700  
##  Mean   :1.095   Mean   :13.15   Mean   :1.764  
##  3rd Qu.:1.100   3rd Qu.:14.50   3rd Qu.:2.000  
##  Max.   :6.400   Max.   :16.60   Max.   :3.200  
##  NA&#39;s   :43      NA&#39;s   :1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(mgus)   <span class="co"># more comprehensive description from _Hisc_ package, loaded by</span></code></pre></div>
<pre><code>## mgus 
## 
##  12  Variables      241  Observations
## ---------------------------------------------------------------------------
## id 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      241        0      241        1      121    80.67       13       25 
##      .25      .50      .75      .90      .95 
##       61      121      181      217      229 
## 
## lowest :   1   2   3   4   5, highest: 237 238 239 240 241
## ---------------------------------------------------------------------------
## age : AGE AT date_on 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      241        0       53    0.999    62.87    13.42       44       48 
##      .25      .50      .75      .90      .95 
##       55       63       72       78       81 
## 
## lowest : 34 35 36 37 38, highest: 84 85 86 87 90
## ---------------------------------------------------------------------------
## sex : Sex 
##        n  missing distinct 
##      241        0        2 
##                         
## Value      female   male
## Frequency     104    137
## Proportion  0.432  0.568
## ---------------------------------------------------------------------------
## dxyr 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      241        0       17     0.97     67.4    3.073       61       63 
##      .25      .50      .75      .90      .95 
##       66       68       70       70       70 
##                                                                       
## Value         56    58    59    60    61    62    63    64    65    66
## Frequency      1     1     5     5     2     7     7    10    10    18
## Proportion 0.004 0.004 0.021 0.021 0.008 0.029 0.029 0.041 0.041 0.075
##                                                     
## Value         67    68    69    70    71    72    73
## Frequency     24    40    45    62     2     1     1
## Proportion 0.100 0.166 0.187 0.257 0.008 0.004 0.004
## ---------------------------------------------------------------------------
## pcdx 
##        n  missing distinct 
##       64      177        4 
##                                   
## Value         AM    LP    MA    MM
## Frequency      8     5     7    44
## Proportion 0.125 0.078 0.109 0.688
## ---------------------------------------------------------------------------
## pctime : Progression to Group 4 (days) 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##       64      177       63        1     4342     3030     1223     1409 
##      .25      .50      .75      .90      .95 
##     2469     3778     5750     8946    10051 
## 
## lowest :   365   700   954  1218  1249, highest:  9723 10109 10359 11354 11685
## ---------------------------------------------------------------------------
## futime : Follow-Up Time 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      241        0      237        1     5425     4222      283      779 
##      .25      .50      .75      .90      .95 
##     2422     5022     8264    11425    12140 
## 
## lowest :     6     7    31    32    39, highest: 12931 13019 13152 14111 14325
## ---------------------------------------------------------------------------
## death 
##        n  missing distinct     Info      Sum     Mean      Gmd 
##      241        0        2    0.186      225   0.9336   0.1245 
## 
## ---------------------------------------------------------------------------
## alb : Serum Albumin 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      210       31       26    0.995    3.204   0.5293      2.3      2.6 
##      .25      .50      .75      .90      .95 
##      2.9      3.2      3.5      3.8      3.9 
## 
## lowest : 1.8 1.9 2.1 2.2 2.3, highest: 4.0 4.1 4.3 4.5 5.1
## ---------------------------------------------------------------------------
## creat : Serum Creatinine 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      198       43       19    0.978    1.095     0.39    0.700    0.800 
##      .25      .50      .75      .90      .95 
##    0.900    1.000    1.100    1.300    1.615 
##                                                                       
## Value        0.6   0.7   0.8   0.9   1.0   1.1   1.2   1.3   1.4   1.5
## Frequency      4    13    26    42    35    29    18    12     4     4
## Proportion 0.020 0.066 0.131 0.212 0.177 0.146 0.091 0.061 0.020 0.020
##                                                                 
## Value        1.6   1.7   2.0   2.5   2.6   3.5   3.6   3.7   6.4
## Frequency      1     3     1     1     1     1     1     1     1
## Proportion 0.005 0.015 0.005 0.005 0.005 0.005 0.005 0.005 0.005
## ---------------------------------------------------------------------------
## hgb : Hemoglobin 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      240        1       66    0.999    13.15    1.865    10.20    11.09 
##      .25      .50      .75      .90      .95 
##    12.20    13.20    14.50    15.11    15.51 
## 
## lowest :  7.4  7.7  8.4  9.5  9.6, highest: 15.9 16.1 16.2 16.5 16.6
## ---------------------------------------------------------------------------
## mspike : Serum M-Spike 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      241        0       23    0.993    1.764   0.4687      1.1      1.3 
##      .25      .50      .75      .90      .95 
##      1.5      1.7      2.0      2.3      2.5 
## 
## lowest : 0.3 0.8 0.9 1.0 1.1, highest: 2.5 2.6 2.7 2.9 3.2
## ---------------------------------------------------------------------------</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">                 <span class="co"># the _rms_ one</span>

mgus_df &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(mgus)         <span class="co"># tidy data frame (important info printed all</span>
                                   <span class="co"># together, and visualization auto-adjusted</span>
                                   <span class="co"># to the consol width)</span>
mgus_df</code></pre></div>
<pre><code>## # A tibble: 241 x 12
##       id   age    sex  dxyr   pcdx pctime futime death   alb creat   hgb
##  * &lt;dbl&gt; &lt;dbl&gt; &lt;fctr&gt; &lt;dbl&gt; &lt;fctr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1    78 female    68   &lt;NA&gt;     NA    748     1   2.8   1.2  11.5
##  2     2    73 female    66     LP   1310   6751     1    NA    NA    NA
##  3     3    87   male    68   &lt;NA&gt;     NA    277     1   2.2   1.1  11.2
##  4     4    86   male    69   &lt;NA&gt;     NA   1815     1   2.8   1.3  15.3
##  5     5    74 female    68   &lt;NA&gt;     NA   2587     1   3.0   0.8   9.8
##  6     6    81   male    68   &lt;NA&gt;     NA    563     1   2.9   0.9  11.5
##  7     7    72 female    68   &lt;NA&gt;     NA   1135     1   3.0   0.8  13.5
##  8     8    79 female    69   &lt;NA&gt;     NA   2016     1   3.1   0.8  15.5
##  9     9    85 female    70   &lt;NA&gt;     NA   2422     1   3.2   1.0  12.4
## 10    10    58   male    65   &lt;NA&gt;     NA   6155     1   3.5   1.0  14.8
## # ... with 231 more rows, and 1 more variables: mspike &lt;dbl&gt;</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Non parametric Kaplan-Meyer estimation of the survival function</li>
</ol>
<ul>
<li>Estimate the survival function from randomization overall and according to sex.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">survfit</span>(<span class="kw">Surv</span>(futime, death) ~<span class="st"> </span><span class="dv">1</span>,
  <span class="dt">data =</span> mgus_df
) %&gt;%
<span class="st">  </span><span class="kw">plot</span>(
    <span class="dt">conf.int  =</span> <span class="ot">TRUE</span>,
    <span class="dt">mark.time =</span> <span class="ot">TRUE</span>,
    <span class="dt">col       =</span> <span class="st">&#39;blue&#39;</span>,
    <span class="dt">main      =</span> <span class="st">&#39;Survival function for mgus data&#39;</span>
)


<span class="kw">survfit</span>(<span class="kw">Surv</span>(futime, death) ~<span class="st"> </span>sex,
  <span class="dt">data =</span> mgus_df
) %&gt;%
<span class="st">  </span><span class="kw">plot</span>(
    <span class="dt">conf.int  =</span> <span class="ot">TRUE</span>,
    <span class="dt">mark.time =</span> <span class="ot">TRUE</span>,
    <span class="dt">main      =</span> <span class="st">&#39;Survival function for mgus data according to sex&#39;</span>,
    <span class="dt">col       =</span> <span class="kw">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>),
    <span class="dt">lty       =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)
)
<span class="kw">legend</span>(
  <span class="dt">x =</span> <span class="dv">10000</span>, <span class="dt">y =</span> <span class="dv">1</span>,
  <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>),
  <span class="dt">col    =</span> <span class="kw">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>),
  <span class="dt">lty    =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)
)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/rmgus_survfit-1.png" width="672" /><img src="SuDACDa-notes_files/figure-html/rmgus_survfit-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># For survival object the package _survminer_ provide ggplot2 plots</span>
<span class="co"># (`?ggsurvplot`) which could be very interesting and quite comprehensive.</span>

<span class="kw">survfit</span>(<span class="kw">Surv</span>(futime, death) ~<span class="st"> </span>sex,
  <span class="dt">data =</span> mgus_df
) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ggsurvplot</span>(
    <span class="dt">conf.int            =</span> <span class="ot">TRUE</span>,                      <span class="co"># draw confidence intervals</span>
    <span class="dt">pval                =</span> <span class="ot">TRUE</span>,                                    <span class="co"># show pvalue</span>
    <span class="dt">pval.method         =</span> <span class="ot">TRUE</span>,                            <span class="co"># print the test name</span>
    <span class="dt">title               =</span> <span class="st">&#39;Survival curves for overall death according to sex.&#39;</span>,
    <span class="dt">xlab                =</span> <span class="st">&#39;Days&#39;</span>,
    <span class="dt">legend              =</span> <span class="st">&#39;right&#39;</span>,                             <span class="co"># legend position</span>
    <span class="dt">legend.title        =</span> <span class="st">&#39;Sex&#39;</span>,
    <span class="dt">legend.labs         =</span> <span class="kw">c</span>(<span class="st">&#39;Female&#39;</span>, <span class="st">&#39;Male&#39;</span>),
    <span class="dt">risk.table          =</span> <span class="ot">TRUE</span>,     <span class="co"># admits interesting options other than TRUE</span>
    <span class="dt">cumcensor           =</span> <span class="ot">TRUE</span>,
    <span class="dt">cumevents           =</span> <span class="ot">TRUE</span>,
    <span class="dt">pval.size           =</span> <span class="fl">3.5</span>,   <span class="co"># from here these are options passed to `ggpar`</span>
    <span class="dt">risk.table.fontsize =</span> <span class="dv">3</span>,     <span class="co"># for a better visualization</span>
    <span class="dt">fontsize            =</span> <span class="dv">3</span>,     <span class="co"># (auto-explicatives)</span>
    <span class="dt">xscale              =</span> <span class="fl">30.44</span>
  )</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/rmgus_survminer-1.png" width="672" /></p>
<blockquote>
<p>Note: No female reaches the end of the f-up!</p>
</blockquote>
<ul>
<li>Test the effect of sex</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using __survival__ (no plot method is provided for this solution)</span>
<span class="kw">survdiff</span>(<span class="kw">Surv</span>(futime, death) ~<span class="st"> </span>sex,
  <span class="dt">data =</span> mgus_df
)</code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(futime, death) ~ sex, data = mgus_df)
## 
##              N Observed Expected (O-E)^2/E (O-E)^2/V
## sex=female 104       94      113      3.08      6.25
## sex=male   137      131      112      3.08      6.25
## 
##  Chisq= 6.2  on 1 degrees of freedom, p= 0.0124</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># using __rms__</span>
dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(mgus_df)  <span class="co"># To evaluate cph, _rms_ needs this object which simply</span>
                         <span class="co"># store statistics about the data.</span>
                         <span class="co"># </span>
                         <span class="co"># Note: the name of the object (i.e. &quot;dd&quot;) has to be </span>
                         <span class="co">#       exactly the same as the one specified into the</span>
                         <span class="co">#       option set just after the `library(rms)` call.</span>
                         <span class="co">#       (See: Chapter settings) </span>
cox_model &lt;-<span class="st"> </span><span class="kw">cph</span>(<span class="kw">Surv</span>(futime, death) ~<span class="st"> </span>sex,
  <span class="dt">data  =</span> mgus_df
)

<span class="kw">summary</span>(cox_model)                             <span class="co"># return effect size and HR w/ CI</span></code></pre></div>
<pre><code>##              Effects              Response : Surv(futime, death) 
## 
##  Factor            Low High Diff. Effect   S.E.    Lower 0.95 Upper 0.95
##  sex - female:male 2   1    NA    -0.33853 0.13603 -0.60514   -0.071916 
##   Hazard Ratio     2   1    NA     0.71282      NA  0.54600    0.930610</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Predict</span>(cox_model) %&gt;%<span class="st">          </span><span class="co"># Compute predicted values and confidence limits</span>
<span class="st">                                </span><span class="co">#</span>
<span class="st">                                </span><span class="co"># Note: pay attention to Title-case &quot;P&quot;redict</span>
<span class="st">  </span><span class="kw">plot</span>(
    <span class="dt">groups =</span> <span class="st">&#39;sex&#39;</span>,
    <span class="dt">anova  =</span> <span class="kw">anova</span>(cox_model),       <span class="co"># Compute and print the $\chi^2$ statistics</span>
    <span class="dt">pval   =</span> <span class="ot">TRUE</span>                    <span class="co"># print the pvalue </span>
)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/mgus_survdiff_and_rms-1.png" width="672" /></p>
</div>
<div id="km1" class="section level2">
<h2><span class="header-section-number">1.4</span> Non parametric Kaplan-Meier estimation of the survival function</h2>
<ol style="list-style-type: decimal">
<li>Let consider a sample of <span class="math inline">\(n = 500\)</span></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">500</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Simulate the dates of entry in the cohort, from January, 2010 to January, 2017</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_days &lt;-<span class="st"> </span><span class="fl">365.25</span> *<span class="st"> </span><span class="dv">7</span>              <span class="co"># Seven years, taking into account bissextiles</span>
time_start &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> n,
  <span class="dt">min =</span> <span class="dv">0</span>,
  <span class="dt">max =</span> n_days
) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">as.Date</span>(<span class="dt">origin =</span> <span class="st">&#39;2010-01-01&#39;</span>)</code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Simulate the data-set of death, assuming exponential death times of mean <span class="math inline">\(2\)</span> years</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean_death_time &lt;-<span class="st"> </span><span class="fl">365.25</span> *<span class="st"> </span><span class="dv">2</span>
death_t         &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">1</span> /<span class="st"> </span>mean_death_time)
status_no_cens  &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, n)</code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Let fix the reference date of the analyses of June, 2017</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">end_date     &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&#39;2017-06-01&#39;</span>)           <span class="co"># Fixed date for the end of f-up</span>
death_r_cens &lt;-<span class="st"> </span><span class="kw">pmin</span>(death_t, end_date -<span class="st"> </span>time_start)
status_cens  &lt;-<span class="st"> </span>status_no_cens -<span class="st"> </span>(death_t ==<span class="st"> </span>death_r_cens)</code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Estimate the survival function from randomization</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">survfit</span>(<span class="kw">Surv</span>(death_r_cens, status_cens) ~<span class="st"> </span><span class="dv">1</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">plot</span>(
    <span class="dt">conf.int  =</span> <span class="ot">TRUE</span>,
    <span class="dt">mark.time =</span> <span class="ot">TRUE</span>,
    <span class="dt">main      =</span> <span class="st">&#39;Survival curve from randomization (right censored at 2017-06-01)&#39;</span>,
    <span class="dt">col       =</span> <span class="st">&#39;blue&#39;</span>,
    <span class="dt">xlab      =</span> <span class="st">&#39;Years&#39;</span>,
    <span class="dt">xscale    =</span> <span class="fl">365.25</span>
)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/ex_surv_curves-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cox.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["SuDACDa-notes.epub", "SuDACDa-notes.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
