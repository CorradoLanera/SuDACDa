<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Survival Data Analysis for Cancer Data</title>
  <meta name="description" content="Examples and exercise from the Politecnico Ph.D. course by prof. Sylvie Chevret and prof. Matthieu Resche-Rigon.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Survival Data Analysis for Cancer Data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://corradolanera.github.io/SuDACDa/" />
  
  <meta property="og:description" content="Examples and exercise from the Politecnico Ph.D. course by prof. Sylvie Chevret and prof. Matthieu Resche-Rigon." />
  <meta name="github-repo" content="CorradoLanera/SuDACDa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Survival Data Analysis for Cancer Data" />
  
  <meta name="twitter:description" content="Examples and exercise from the Politecnico Ph.D. course by prof. Sylvie Chevret and prof. Matthieu Resche-Rigon." />
  

<meta name="author" content="Corrado Lanera, Danila Azzolina, Daniele Bottigliengo">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="survival.html">
<link rel="next" href="competing-risk.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Survival Data Analysis for Cancer Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributions"><i class="fa fa-check"></i>Contributions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#settings"><i class="fa fa-check"></i>Settings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="survival.html"><a href="survival.html"><i class="fa fa-check"></i><b>1</b> <em>Monday</em>: Introduction to Survival Analyses and simulation of data</a><ul>
<li class="chapter" data-level="1.1" data-path="survival.html"><a href="survival.html#key1"><i class="fa fa-check"></i><b>1.1</b> Key (operative) concepts</a></li>
<li class="chapter" data-level="1.2" data-path="survival.html"><a href="survival.html#sumulation1"><i class="fa fa-check"></i><b>1.2</b> Simulated Data</a></li>
<li class="chapter" data-level="1.3" data-path="survival.html"><a href="survival.html#mgus"><i class="fa fa-check"></i><b>1.3</b> <code>mgus</code> data from <strong>survival</strong> package</a></li>
<li class="chapter" data-level="1.4" data-path="survival.html"><a href="survival.html#km1"><i class="fa fa-check"></i><b>1.4</b> Non parametric Kaplan-Meier estimation of the survival function</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i><b>2</b> <em>Tuesday</em>: Cox models</a><ul>
<li class="chapter" data-level="2.1" data-path="cox.html"><a href="cox.html#key2"><i class="fa fa-check"></i><b>2.1</b> Key (operative) concepts</a></li>
<li class="chapter" data-level="2.2" data-path="cox.html"><a href="cox.html#test2"><i class="fa fa-check"></i><b>2.2</b> Basic tests and funtions</a><ul>
<li class="chapter" data-level="2.2.1" data-path="cox.html"><a href="cox.html#impact-of-sex-on-death-sex2"><i class="fa fa-check"></i><b>2.2.1</b> Impact of sex on death {sex2}</a></li>
<li class="chapter" data-level="2.2.2" data-path="cox.html"><a href="cox.html#age2"><i class="fa fa-check"></i><b>2.2.2</b> Impact of age on death</a></li>
<li class="chapter" data-level="2.2.3" data-path="cox.html"><a href="cox.html#ast2"><i class="fa fa-check"></i><b>2.2.3</b> Impact of aspartate aminotransferase (<code>ast</code>) on death</a></li>
<li class="chapter" data-level="2.2.4" data-path="cox.html"><a href="cox.html#platelet2"><i class="fa fa-check"></i><b>2.2.4</b> Impact of <strong>platelet</strong> on death</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cox.html"><a href="cox.html#adjusted2"><i class="fa fa-check"></i><b>2.3</b> Investigation on adjusted variables and interactions</a></li>
<li class="chapter" data-level="2.4" data-path="cox.html"><a href="cox.html#longitudinal"><i class="fa fa-check"></i><b>2.4</b> Longitudinal suvival data analayses</a><ul>
<li class="chapter" data-level="2.4.1" data-path="cox.html"><a href="cox.html#bilurubine2"><i class="fa fa-check"></i><b>2.4.1</b> Impact of bilurubine of death</a></li>
<li class="chapter" data-level="2.4.2" data-path="cox.html"><a href="cox.html#ast_full2"><i class="fa fa-check"></i><b>2.4.2</b> Impact of ast</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="cox.html"><a href="cox.html#prognostic2"><i class="fa fa-check"></i><b>2.5</b> Prognostic model</a><ul>
<li class="chapter" data-level="2.5.1" data-path="cox.html"><a href="cox.html#prognostic-model-with-ascites-edema-sex-bili-ast-platelet-stage"><i class="fa fa-check"></i><b>2.5.1</b> prognostic model with <code>àscites</code>, <code>edema</code>, <code>sex</code>, <code>bili</code>, <code>ast</code>, <code>platelet</code>, <code id="model2">stage</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="competing-risk.html"><a href="competing-risk.html"><i class="fa fa-check"></i><b>3</b> <em>Wednesday</em>: Competing risk</a><ul>
<li class="chapter" data-level="3.1" data-path="competing-risk.html"><a href="competing-risk.html#key3"><i class="fa fa-check"></i><b>3.1</b> Key (operative) concepts</a></li>
<li class="chapter" data-level="3.2" data-path="competing-risk.html"><a href="competing-risk.html#data-manipulation"><i class="fa fa-check"></i><b>3.2</b> Data manipulation</a></li>
<li class="chapter" data-level="3.3" data-path="competing-risk.html"><a href="competing-risk.html#simulation-of-competing-risk"><i class="fa fa-check"></i><b>3.3</b> Simulation of Competing risk</a></li>
<li class="chapter" data-level="3.4" data-path="competing-risk.html"><a href="competing-risk.html#estimation-of-the-effect-of-sex-on-mgus-incidence"><i class="fa fa-check"></i><b>3.4</b> Estimation of the effect of sex on MGUS incidence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i>Software</a><ul>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="software.html"><a href="software.html#system-information"><i class="fa fa-check"></i>System Information</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/CorradoLanera/SuDACDa" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Survival Data Analysis for Cancer Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cox" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> <em>Tuesday</em>: Cox models</h1>
<div id="key2" class="section level2">
<h2><span class="header-section-number">2.1</span> Key (operative) concepts</h2>
<ol style="list-style-type: decimal">
<li>Non-informative censoring assumption!</li>
</ol>
<blockquote>
<p>We cannot test for it, but we can be convinced of it</p>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li>Test any covariates for proportional hazard. If fail:</li>
</ol>
<ul>
<li>If <span class="math inline">\(H_0\)</span> is valid, it is not a problem</li>
<li>Is it due to outliers?</li>
<li>Does this variable really need?</li>
<li>… do you really think that proportional of hazard should hold? What about shift to a different model?</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Test continuous variable for log-linearity. If fail:</li>
</ol>
<ul>
<li>try a transformation of the variable (i.e., log, spline, …)</li>
<li>if it is not possible (e.g. <em>U-shape</em>) perform a categorization</li>
</ul>
<blockquote>
<p>When performing categorization do not base it on the p-value: you have to explain why this choiche is clinically relevant and not statistically significant!</p>
</blockquote>
<ol start="4" style="list-style-type: decimal">
<li>The biggest problem with databases with more observations for each patients is not the model but to produce a table with the right information in the right position. In particular we need the following columns</li>
</ol>
<ul>
<li>id</li>
<li>start</li>
<li>end</li>
<li>event</li>
<li>covariates…</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Get results easy to explain to / understand by a clinician!</li>
</ol>
</div>
<div id="test2" class="section level2">
<h2><span class="header-section-number">2.2</span> Basic tests and funtions</h2>
<p>For this part we will use the data <code>pbc</code> (<code>?pbc</code>) from the package <strong>survival</strong>.</p>
<blockquote>
<p>Note: <code>data(pbc)</code> load the <code>pbc</code> data-set and the <code>pbcseq</code> one, so on one side we do not need to call <code>data(pbcseq)</code> to load the letter, on the other side <code>data(pbcseq)</code> will throw an error because to load it we have to call <code>data(pbc)</code>. (We will use both data-sets.)</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">171003</span>)
<span class="kw">data</span>(pbc)                                                    <span class="co"># load the data-set</span>
<span class="co"># ?pbc</span>
pbc_df &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(pbc)                       <span class="co"># create the tibble version of it</span>
dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(pbc_df)     <span class="co"># store in the dd variable its `datadist()` for _rms_</span>

pbc_df                                                       <span class="co"># give a look at it</span></code></pre></div>
<pre><code>## # A tibble: 418 x 20
##       id  time status   trt      age    sex ascites hepato spiders edema
##    &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;    &lt;dbl&gt; &lt;fctr&gt;   &lt;int&gt;  &lt;int&gt;   &lt;int&gt; &lt;dbl&gt;
##  1     1   400      2     1 58.76523      f       1      1       1   1.0
##  2     2  4500      0     1 56.44627      f       0      1       1   0.0
##  3     3  1012      2     1 70.07255      m       0      0       0   0.5
##  4     4  1925      2     1 54.74059      f       0      1       1   0.5
##  5     5  1504      1     2 38.10541      f       0      1       1   0.0
##  6     6  2503      2     2 66.25873      f       0      1       0   0.0
##  7     7  1832      0     2 55.53457      f       0      1       0   0.0
##  8     8  2466      2     2 53.05681      f       0      0       0   0.0
##  9     9  2400      2     1 42.50787      f       0      0       1   0.0
## 10    10    51      2     2 70.55989      f       1      0       1   1.0
## # ... with 408 more rows, and 10 more variables: bili &lt;dbl&gt;, chol &lt;int&gt;,
## #   albumin &lt;dbl&gt;, copper &lt;int&gt;, alk.phos &lt;dbl&gt;, ast &lt;dbl&gt;, trig &lt;int&gt;,
## #   platelet &lt;int&gt;, protime &lt;dbl&gt;, stage &lt;int&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describe</span>(pbc_df)                                 <span class="co"># and whatch at some statistics</span></code></pre></div>
<pre><code>## pbc_df 
## 
##  20  Variables      418  Observations
## ---------------------------------------------------------------------------
## id 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      418        0      418        1    209.5    139.7    21.85    42.70 
##      .25      .50      .75      .90      .95 
##   105.25   209.50   313.75   376.30   397.15 
## 
## lowest :   1   2   3   4   5, highest: 414 415 416 417 418
## ---------------------------------------------------------------------------
## time 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      418        0      399        1     1918     1253    245.1    606.8 
##      .25      .50      .75      .90      .95 
##   1092.8   1730.0   2613.5   3524.2   4040.6 
## 
## lowest :   41   43   51   71   77, highest: 4500 4509 4523 4556 4795
## ---------------------------------------------------------------------------
## status 
##        n  missing distinct     Info     Mean      Gmd 
##      418        0        3    0.772   0.8301   0.9699 
##                             
## Value          0     1     2
## Frequency    232    25   161
## Proportion 0.555 0.060 0.385
## ---------------------------------------------------------------------------
## trt 
##        n  missing distinct     Info     Mean      Gmd 
##      312      106        2     0.75    1.494   0.5015 
##                       
## Value          1     2
## Frequency    158   154
## Proportion 0.506 0.494
## ---------------------------------------------------------------------------
## age 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      418        0      344        1    50.74    11.96    33.84    36.37 
##      .25      .50      .75      .90      .95 
##    42.83    51.00    58.24    64.30    67.92 
## 
## lowest : 26.27789 28.88433 29.55510 30.27515 30.57358
## highest: 74.52430 75.00068 75.01164 76.70910 78.43943
## ---------------------------------------------------------------------------
## sex 
##        n  missing distinct 
##      418        0        2 
##                       
## Value          m     f
## Frequency     44   374
## Proportion 0.105 0.895
## ---------------------------------------------------------------------------
## ascites 
##        n  missing distinct     Info      Sum     Mean      Gmd 
##      312      106        2    0.213       24  0.07692   0.1425 
## 
## ---------------------------------------------------------------------------
## hepato 
##        n  missing distinct     Info      Sum     Mean      Gmd 
##      312      106        2     0.75      160   0.5128   0.5013 
## 
## ---------------------------------------------------------------------------
## spiders 
##        n  missing distinct     Info      Sum     Mean      Gmd 
##      312      106        2    0.616       90   0.2885   0.4118 
## 
## ---------------------------------------------------------------------------
## edema 
##        n  missing distinct     Info     Mean      Gmd 
##      418        0        3    0.391   0.1005   0.1756 
##                             
## Value        0.0   0.5   1.0
## Frequency    354    44    20
## Proportion 0.847 0.105 0.048
## ---------------------------------------------------------------------------
## bili 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      418        0       98    0.998    3.221    3.742     0.50     0.60 
##      .25      .50      .75      .90      .95 
##     0.80     1.40     3.40     8.03    14.00 
## 
## lowest :  0.3  0.4  0.5  0.6  0.7, highest: 21.6 22.5 24.5 25.5 28.0
## ---------------------------------------------------------------------------
## chol 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      284      134      201        1    369.5    194.5    188.4    213.6 
##      .25      .50      .75      .90      .95 
##    249.5    309.5    400.0    560.8    674.0 
## 
## lowest :  120  127  132  149  151, highest: 1336 1480 1600 1712 1775
## ---------------------------------------------------------------------------
## albumin 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      418        0      154        1    3.497    0.473    2.750    2.967 
##      .25      .50      .75      .90      .95 
##    3.243    3.530    3.770    4.010    4.141 
## 
## lowest : 1.96 2.10 2.23 2.27 2.31, highest: 4.30 4.38 4.40 4.52 4.64
## ---------------------------------------------------------------------------
## copper 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      310      108      158        1    97.65    83.16    17.45    24.00 
##      .25      .50      .75      .90      .95 
##    41.25    73.00   123.00   208.10   249.20 
## 
## lowest :   4   9  10  11  12, highest: 412 444 464 558 588
## ---------------------------------------------------------------------------
## alk.phos 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      312      106      295        1     1983     1760    599.6    663.0 
##      .25      .50      .75      .90      .95 
##    871.5   1259.0   1980.0   3826.4   6669.9 
## 
## lowest :   289.0   310.0   369.0   377.0   414.0
## highest: 11046.6 11320.2 11552.0 12258.8 13862.4
## ---------------------------------------------------------------------------
## ast 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      312      106      179        1    122.6    60.45    54.25    60.45 
##      .25      .50      .75      .90      .95 
##    80.60   114.70   151.90   196.47   219.25 
## 
## lowest :  26.35  28.38  41.85  43.40  45.00, highest: 288.00 299.15 328.60 338.00 457.25
## ---------------------------------------------------------------------------
## trig 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      282      136      146        1    124.7    64.07    56.00    63.10 
##      .25      .50      .75      .90      .95 
##    84.25   108.00   151.00   195.00   230.95 
## 
## lowest :  33  44  46  49  50, highest: 319 322 382 432 598
## ---------------------------------------------------------------------------
## platelet 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      407       11      243        1      257    109.7    114.9    138.2 
##      .25      .50      .75      .90      .95 
##    188.5    251.0    318.0    386.2    430.0 
## 
## lowest :  62  70  71  76  79, highest: 517 518 539 563 721
## ---------------------------------------------------------------------------
## protime 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      416        2       48    0.998    10.73    1.029     9.60     9.80 
##      .25      .50      .75      .90      .95 
##    10.00    10.60    11.10    12.00    12.45 
## 
## lowest :  9.0  9.1  9.2  9.3  9.4, highest: 13.8 14.1 15.2 17.1 18.0
## ---------------------------------------------------------------------------
## stage 
##        n  missing distinct     Info     Mean      Gmd 
##      412        6        4    0.893    3.024   0.9519 
##                                   
## Value          1     2     3     4
## Frequency     21    92   155   144
## Proportion 0.051 0.223 0.376 0.350
## ---------------------------------------------------------------------------</code></pre>
<div id="impact-of-sex-on-death-sex2" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Impact of sex on death {sex2}</h3>
<p>First of all we have to ask to our self, and to the clinicians, some questions:</p>
<ol style="list-style-type: decimal">
<li><p>There are non-informative censoring? Yes, because there is a final data-independent date (i.e. July, 1986). This is completely non-informative with regards to the patients. So we can suspect a non-informative censoring and start investigations using Cox model.</p></li>
<li><p>What we have to do with the transplant? I.e., <code>event</code> has three levels: censored, transplant, dead; how we have to consider transplanted patients? In this case, clinicians answered that the transplant status is completely random! So, we can believe that it is a non-informative censoring.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p></li>
</ol>
<p>Moreover we have to consider, before to start, that <code>sex</code> is a categorical variable, so we have to check (only) the proportionality of the hazards.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using _survival_ (Cox model for proportional hazard against sex)</span>
cox_sex &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>sex,
  <span class="dt">data =</span> pbc_df
)

<span class="kw">cox.zph</span>(cox_sex)                           <span class="co"># test for proportionality of hazards</span></code></pre></div>
<pre><code>##          rho chisq     p
## sexf -0.0563 0.502 0.479</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cox.zph</span>(cox_sex) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">plot</span>(
    <span class="dt">main =</span> <span class="st">&#39;Graph of the scaled Schoenfeld residuals for sex, along with a smooth curve&#39;</span>,
    <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>
)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>The proportional hazard assumption is not invalidate so we can continue with the analyses.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(cox_sex)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status == 2) ~ sex, data = pbc_df)
## 
##   n= 418, number of events= 161 
## 
##         coef exp(coef) se(coef)      z Pr(&gt;|z|)  
## sexf -0.3809    0.6833   0.2221 -1.714   0.0864 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##      exp(coef) exp(-coef) lower .95 upper .95
## sexf    0.6833      1.464    0.4421     1.056
## 
## Concordance= 0.518  (se = 0.013 )
## Rsquare= 0.006   (max possible= 0.985 )
## Likelihood ratio test= 2.69  on 1 df,   p=0.101
## Wald test            = 2.94  on 1 df,   p=0.08645
## Score (logrank) test = 2.97  on 1 df,   p=0.08459</code></pre>
<p>The effect of sex, viewed as hazard ration, say that if you are a female it seems that you have a lower risk to die, but it is not significant (i.e., <span class="math inline">\(p\)</span>-value <span class="math inline">\(&gt; 0.05\)</span> and CI include <span class="math inline">\(1\)</span>).</p>
<blockquote>
<p>Anyone have the same risk, 1, to die… What the hazard ration say is that if at the begin of a day you are alive, if you a re a woman you have 32% less probability to die before the end of the day respect a men.</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using rms</span>
rms_sex &lt;-<span class="st"> </span><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>sex,
  <span class="dt">data =</span> pbc_df,
  <span class="dt">x    =</span> <span class="ot">TRUE</span>,                    <span class="co"># to compute cox.zph, we need to store x and y</span>
  <span class="dt">y    =</span> <span class="ot">TRUE</span>
)

<span class="kw">cox.zph</span>(rms_sex)</code></pre></div>
<pre><code>##           rho chisq     p
## sex=f -0.0563 0.501 0.479</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cox.zph</span>(rms_sex) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">plot</span>(<span class="dt">col =</span> <span class="st">&#39;green&#39;</span>)                       <span class="co"># exactly the same results as before!</span></code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(rms_sex)       <span class="co"># a cleaner and more informative output, note Low and High</span></code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor        Low High Diff. Effect  S.E.    Lower 0.95 Upper 0.95
##  sex - m:f     2   1    NA    0.38206 0.22205 -0.053149  0.81727   
##   Hazard Ratio 2   1    NA    1.46530      NA  0.948240  2.26430</code></pre>
</div>
<div id="age2" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Impact of age on death</h3>
<ul>
<li>we have to check for the proportional HR</li>
<li>It is continuous variable, we have to check the the log-linearity too</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using survival</span>
cox_age &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>age,
  <span class="dt">data =</span> pbc_df
)

<span class="kw">cox.zph</span>(cox_age)</code></pre></div>
<pre><code>##         rho chisq    p
## age -0.0304 0.139 0.71</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cox.zph</span>(cox_age) %&gt;%
<span class="st">  </span><span class="kw">plot</span>(<span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The proportional hazard hypothesis is not invalidated</p>
<blockquote>
<p>The outputs of rcspline.plot are a plot and a very long matrix with the values of xe, lower, upper. The latters are not of our interest, but there are no options to not get them. So we include the command into <code>invisible(capture.output(.))</code> box.<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a></p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">invisible</span>(<span class="kw">capture.output</span>(<span class="kw">rcspline.plot</span>(
  <span class="dt">x       =</span> pbc_df$age,
  <span class="dt">y       =</span> pbc_df$time,
  <span class="dt">event   =</span> pbc_df$status ==<span class="st"> </span><span class="dv">2</span>,
  <span class="dt">nk      =</span> <span class="dv">3</span>,                   <span class="co"># default are 5 knots, too mutch for this model</span>
<span class="co">#  model   = &#39;cox&#39;,          # If event is present, model is assumed to be &quot;cox&quot;</span>
  <span class="dt">xlab    =</span> <span class="st">&#39;Age&#39;</span>,
  <span class="dt">statloc =</span> <span class="st">&#39;ll&#39;</span>
)))</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The log-linearity is not invalidated</p>
<blockquote>
<p>Note: sometimes you <em>know</em> the answer for log-linearity (for any reason), in those cases do not test for it!! (It is not very powerful so for small sample sizes it never reject it)</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(cox_age)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status == 2) ~ age, data = pbc_df)
## 
##   n= 418, number of events= 161 
## 
##         coef exp(coef) se(coef)     z Pr(&gt;|z|)    
## age 0.039185  1.039963 0.007847 4.994 5.92e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##     exp(coef) exp(-coef) lower .95 upper .95
## age      1.04     0.9616     1.024     1.056
## 
## Concordance= 0.616  (se = 0.025 )
## Rsquare= 0.058   (max possible= 0.985 )
## Likelihood ratio test= 25.19  on 1 df,   p=5.205e-07
## Wald test            = 24.94  on 1 df,   p=5.922e-07
## Score (logrank) test = 25.3  on 1 df,   p=4.918e-07</code></pre>
<p>The effect is significant but too low to understand, so we can change the “measure of time” to expand it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span><span class="kw">I</span>(age /<span class="st"> </span><span class="dv">10</span>),          <span class="co"># consider 10 years as one</span>
  <span class="dt">data =</span> pbc_df
) %&gt;%
<span class="st">  </span>summary</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status == 2) ~ I(age/10), data = pbc_df)
## 
##   n= 418, number of events= 161 
## 
##              coef exp(coef) se(coef)     z Pr(&gt;|z|)    
## I(age/10) 0.39185   1.47972  0.07847 4.994 5.92e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##           exp(coef) exp(-coef) lower .95 upper .95
## I(age/10)      1.48     0.6758     1.269     1.726
## 
## Concordance= 0.616  (se = 0.025 )
## Rsquare= 0.058   (max possible= 0.985 )
## Likelihood ratio test= 25.19  on 1 df,   p=5.205e-07
## Wald test            = 24.94  on 1 df,   p=5.922e-07
## Score (logrank) test = 25.3  on 1 df,   p=4.918e-07</code></pre>
<p>Here, the effect is increased, but we have to pay attention the an increment of “one”, here, corresponds to an increment of ten years!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using rms</span>
rms_age &lt;-<span class="st"> </span><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>age,
  <span class="dt">data =</span> pbc_df,
  <span class="dt">x    =</span> <span class="ot">TRUE</span>,                    <span class="co"># to compute cox.zph, we need to store x and y</span>
  <span class="dt">y    =</span> <span class="ot">TRUE</span>
)

<span class="kw">Predict</span>(rms_age) %&gt;%
<span class="st">  </span>plot</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(rms_age)  <span class="co"># _rms_ show effects from the Lower to the Higher limit of IQR</span></code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor        Low    High   Diff.  Effect  S.E.    Lower 0.95 Upper 0.95
##  age           42.832 58.241 15.409 0.60379 0.12091 0.36681    0.84076   
##   Hazard Ratio 42.832 58.241 15.409 1.82900      NA 1.44310    2.31810</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">                  <span class="co"># and report the different between them as well as the HR, so</span>
                  <span class="co"># we do not need to perform triky transformation which asks</span>
                  <span class="co"># for an alterate interpretation of the result</span></code></pre></div>
<p>In particular, the effect quite doubled in fifteen years.<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>.</p>
</div>
<div id="ast2" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Impact of aspartate aminotransferase (<code>ast</code>) on death</h3>
<ul>
<li>same of age</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rms_ast &lt;-<span class="st"> </span><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>ast,
  <span class="dt">data =</span> pbc_df,
  <span class="dt">x    =</span> <span class="ot">TRUE</span>,
  <span class="dt">y    =</span> <span class="ot">TRUE</span>
)

<span class="kw">cox.zph</span>(rms_ast)</code></pre></div>
<pre><code>##         rho chisq     p
## ast -0.0641 0.274 0.601</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cox.zph</span>(rms_ast) %&gt;%
<span class="st">  </span><span class="kw">plot</span>(<span class="dt">col =</span> <span class="st">&#39;green&#39;</span>)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>The proportional hazard assumption is not violated, but by the graph it seams not that linear. Try to transform it using the <span class="math inline">\(log()\)</span> transformation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log_ast &lt;-<span class="st"> </span><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span><span class="kw">log</span>(ast),
  <span class="dt">data =</span> pbc_df,
  <span class="dt">x    =</span> <span class="ot">TRUE</span>,
  <span class="dt">y    =</span> <span class="ot">TRUE</span>
)

<span class="kw">cox.zph</span>(log_ast)</code></pre></div>
<pre><code>##      rho chisq     p
## ast -0.1  1.13 0.289</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cox.zph</span>(log_ast) %&gt;%
<span class="st">  </span><span class="kw">plot</span>(<span class="dt">col =</span> <span class="st">&#39;green&#39;</span>)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The situation is not much better…but we can say that there exists a line living in the middle of the band…so we are not very happy but we accept it.</p>
<p>Let’s test for log-linearity</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">invisible</span>(<span class="kw">capture.output</span>(<span class="kw">rcspline.plot</span>(
  <span class="dt">x       =</span> <span class="kw">log</span>(pbc_df$ast),
  <span class="dt">y       =</span> pbc_df$time,
  <span class="dt">event   =</span> pbc_df$status ==<span class="st"> </span><span class="dv">2</span>,
  <span class="dt">xlab    =</span> <span class="st">&#39;ast&#39;</span>,
  <span class="dt">statloc =</span> <span class="st">&#39;ll&#39;</span>
)))</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>The log-linear assumption is not violated.</p>
<p>Finally, look at the effect of the log of <code>ast</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(log_ast)</code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor        Low  High  Diff. Effect  S.E.    Lower 0.95 Upper 0.95
##  ast           80.6 151.9 71.3  0.69872 0.12499 0.45374    0.9437    
##   Hazard Ratio 80.6 151.9 71.3  2.01120      NA 1.57420    2.5695</code></pre>
<p>It is significantly protective, with doubling the effect between the borders of the IQR.</p>
</div>
<div id="platelet2" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Impact of <strong>platelet</strong> on death</h3>
<ul>
<li>same of age</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rms_platelet &lt;-<span class="st"> </span><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>platelet,
  <span class="dt">data =</span> pbc_df,
  <span class="dt">x    =</span> <span class="ot">TRUE</span>,
  <span class="dt">y    =</span> <span class="ot">TRUE</span>
)

<span class="kw">cox.zph</span>(rms_platelet)</code></pre></div>
<pre><code>##             rho chisq     p
## platelet 0.0688     1 0.316</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cox.zph</span>(rms_platelet) %&gt;%
<span class="st">  </span><span class="kw">plot</span>(<span class="dt">col =</span> <span class="st">&#39;green&#39;</span>)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">invisible</span>(<span class="kw">capture.output</span>(<span class="kw">rcspline.plot</span>(
  <span class="dt">x       =</span> pbc_df$platelet %&gt;%<span class="st"> </span>as.numeric,
  <span class="dt">y       =</span> pbc_df$time,
  <span class="dt">event   =</span> pbc_df$status ==<span class="st"> </span><span class="dv">2</span>,
  <span class="dt">xlab    =</span> <span class="st">&#39;Platelet&#39;</span>,
  <span class="dt">statloc =</span> <span class="st">&#39;ll&#39;</span>
)))</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<p>The log-linear plot has a U-shape so, standard transformation are not good. We can try to perform a categorization. Two strategy: 1. look at the log-linear plot and try to find a good cut-points, but we have to explain how we have defined them (and “use the p-value” is not a good strategy) 2. Use standard non related cutoff, such as median or quartiles</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cox_cut_platelet &lt;-<span class="st"> </span><span class="kw">coxph</span>(
  <span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span><span class="kw">cut</span>(platelet, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">400</span>, <span class="dv">1000</span>)),
  <span class="dt">data =</span> pbc_df
)

<span class="kw">cox.zph</span>(cox_cut_platelet)</code></pre></div>
<pre><code>##                                                    rho   chisq     p
## cut(platelet, c(0, 150, 400, 1000))(150,400]   0.06413 0.62938 0.428
## cut(platelet, c(0, 150, 400, 1000))(400,1e+03] 0.00345 0.00181 0.966
## GLOBAL                                              NA 0.74607 0.689</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cox.zph</span>(cox_cut_platelet) %&gt;%
<span class="st">  </span><span class="kw">plot</span>(<span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-16-1.png" width="672" /><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(cox_cut_platelet)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status == 2) ~ cut(platelet, c(0, 
##     150, 400, 1000)), data = pbc_df)
## 
##   n= 407, number of events= 155 
##    (11 observations deleted due to missingness)
## 
##                                                   coef exp(coef) se(coef)
## cut(platelet, c(0, 150, 400, 1000))(150,400]   -0.7164    0.4885   0.1948
## cut(platelet, c(0, 150, 400, 1000))(400,1e+03] -0.8445    0.4298   0.3352
##                                                     z Pr(&gt;|z|)    
## cut(platelet, c(0, 150, 400, 1000))(150,400]   -3.678 0.000235 ***
## cut(platelet, c(0, 150, 400, 1000))(400,1e+03] -2.519 0.011755 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##                                                exp(coef) exp(-coef)
## cut(platelet, c(0, 150, 400, 1000))(150,400]      0.4885      2.047
## cut(platelet, c(0, 150, 400, 1000))(400,1e+03]    0.4298      2.327
##                                                lower .95 upper .95
## cut(platelet, c(0, 150, 400, 1000))(150,400]      0.3335    0.7156
## cut(platelet, c(0, 150, 400, 1000))(400,1e+03]    0.2228    0.8290
## 
## Concordance= 0.561  (se = 0.018 )
## Rsquare= 0.031   (max possible= 0.984 )
## Likelihood ratio test= 12.68  on 2 df,   p=0.001766
## Wald test            = 14.53  on 2 df,   p=0.0006987
## Score (logrank) test = 15.19  on 2 df,   p=0.0005032</code></pre>
<p>But here the reference level, i.e. the contrast, is the lower level but the interested is what happen if we lie above or over the standard values, so we have to relevel the category to make the medium level as the reference one, i.e. the first.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pbc_df &lt;-<span class="st"> </span>pbc_df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">platelet_ref =</span> <span class="kw">cut</span>(pbc_df$platelet, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">400</span>, <span class="dv">1000</span>)) %&gt;%
<span class="st">                      </span><span class="kw">relevel</span>(<span class="dt">ref =</span> <span class="st">&quot;(150,400]&quot;</span>)
)

cox_relev_platelet &lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>platelet_ref,
  <span class="dt">data =</span> pbc_df
)

<span class="kw">summary</span>(cox_relev_platelet)</code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status == 2) ~ platelet_ref, data = pbc_df)
## 
##   n= 407, number of events= 155 
##    (11 observations deleted due to missingness)
## 
##                            coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## platelet_ref(0,150]      0.7164    2.0471   0.1948  3.678 0.000235 ***
## platelet_ref(400,1e+03] -0.1281    0.8798   0.3046 -0.420 0.674235    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##                         exp(coef) exp(-coef) lower .95 upper .95
## platelet_ref(0,150]        2.0471     0.4885    1.3975     2.999
## platelet_ref(400,1e+03]    0.8798     1.1366    0.4843     1.598
## 
## Concordance= 0.561  (se = 0.018 )
## Rsquare= 0.031   (max possible= 0.984 )
## Likelihood ratio test= 12.68  on 2 df,   p=0.001766
## Wald test            = 14.53  on 2 df,   p=0.0006987
## Score (logrank) test = 15.19  on 2 df,   p=0.0005032</code></pre>
</div>
</div>
<div id="adjusted2" class="section level2">
<h2><span class="header-section-number">2.3</span> Investigation on adjusted variables and interactions</h2>
<p>Clinician: what is the effect of treatment (<code>trt</code>) on death?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>trt,
  <span class="dt">data =</span> pbc_df
) %&gt;%<span class="st"> </span>
<span class="st">  </span>summary</code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor        Low High Diff. Effect    S.E.    Lower 0.95 Upper 0.95
##  trt           1   2    1     -0.057189 0.17916 -0.40835   0.29397   
##   Hazard Ratio 1   2    1      0.944420      NA  0.66475   1.34170</code></pre>
<p>No significant effect for treatment.</p>
<p>Clinician: an adjusted with edema?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>trt +<span class="st"> </span>edema,
  <span class="dt">data =</span> pbc_df
) %&gt;%<span class="st"> </span>
<span class="st">  </span>summary</code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor        Low High Diff. Effect    S.E.    Lower 0.95 Upper 0.95
##  trt           1   2    1     -0.065946 0.17953 -0.41781    0.28592  
##   Hazard Ratio 1   2    1      0.936180      NA  0.65849    1.33100  
##  edema         0   1    1      2.280700 0.25761  1.77580    2.78560  
##   Hazard Ratio 0   1    1      9.783600      NA  5.90510   16.21000</code></pre>
<p>No effect for treatment nor edema</p>
<p>Clinicians: and what about their interaction?<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>trt *<span class="st"> </span>edema,
  <span class="dt">data =</span> pbc_df
) %&gt;%<span class="st"> </span>
<span class="st">  </span>summary</code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor        Low High Diff. Effect   S.E.    Lower 0.95 Upper 0.95
##  trt           1   2    1     -0.24014 0.22959 -0.69012    0.20984  
##   Hazard Ratio 1   2    1      0.78652      NA  0.50151    1.23350  
##  edema         0   1    1      2.62340 0.37161  1.89500    3.35170  
##   Hazard Ratio 0   1    1     13.78200      NA  6.65280   28.55200  
## 
## Adjusted to: trt=1 edema=0.5</code></pre>
<p>No effect.</p>
<p>Clinicians: and what about adjusted with stage?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">adj_pbc &lt;-<span class="st"> </span>pbc_df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">stage_fct =</span> <span class="kw">factor</span>(stage))

dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(adj_pbc)

<span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>trt +<span class="st"> </span>stage_fct,
  <span class="dt">data =</span> adj_pbc
) %&gt;%<span class="st"> </span>
<span class="st">  </span>summary</code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor          Low High Diff. Effect   S.E.    Lower 0.95 Upper 0.95
##  trt             1   2     1    -0.14713 0.17989 -0.49971    0.20545  
##   Hazard Ratio   1   2     1     0.86318      NA  0.60671    1.22810  
##  stage_fct - 1:3 3   1    NA    -2.17290 1.01080 -4.15410   -0.19176  
##   Hazard Ratio   3   1    NA     0.11384      NA  0.01570    0.82550  
##  stage_fct - 2:3 3   2    NA    -0.54826 0.29344 -1.12340    0.02687  
##   Hazard Ratio   3   2    NA     0.57795      NA  0.32517    1.02720  
##  stage_fct - 4:3 3   4    NA     0.91613 0.19771  0.52862    1.30360  
##   Hazard Ratio   3   4    NA     2.49960      NA  1.69660    3.68270</code></pre>
<p>Treatment still with no significant effect. <code>stage</code> has some effects, i.e. from the 3 to 1 or to 4,</p>
<p>Clinicians: oh, so let’s look at the interactions!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rms_trt_stage &lt;-<span class="st"> </span><span class="kw">cph</span>(<span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~<span class="st"> </span>trt *<span class="st"> </span>stage,
  <span class="dt">data =</span> adj_pbc
)

<span class="kw">summary</span>(rms_trt_stage)</code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor        Low High Diff. Effect   S.E.    Lower 0.95 Upper 0.95
##  trt           1   2    1     -0.15717 0.20284 -0.55473   0.24039   
##   Hazard Ratio 1   2    1      0.85456      NA  0.57423   1.27170   
##  stage         2   4    2      1.61630 0.33135  0.96682   2.26570   
##   Hazard Ratio 2   4    2      5.03420      NA  2.62960   9.63790   
## 
## Adjusted to: trt=1 stage=3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Predict</span>(rms_trt_stage) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">anova =</span> <span class="kw">anova</span>(rms_trt_stage), <span class="dt">pval =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Predict</span>(rms_trt_stage) %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">anova =</span> <span class="kw">anova</span>(rms_trt_stage), <span class="dt">pval =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<p>Treatment continue to have no effect</p>
</div>
<div id="longitudinal" class="section level2">
<h2><span class="header-section-number">2.4</span> Longitudinal suvival data analayses</h2>
<p>Load a data-set, update the <code>datadist()</code> for the <strong>rms</strong> package, and take a look at the data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pbcseq_df &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(pbcseq)
dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(pbcseq_df)

pbcseq_df</code></pre></div>
<pre><code>## # A tibble: 1,945 x 19
##       id futime status   trt      age    sex   day ascites hepato spiders
##    &lt;int&gt;  &lt;int&gt;  &lt;int&gt; &lt;int&gt;    &lt;dbl&gt; &lt;fctr&gt; &lt;int&gt;   &lt;int&gt;  &lt;int&gt;   &lt;int&gt;
##  1     1    400      2     1 58.76523      f     0       1      1       1
##  2     1    400      2     1 58.76523      f   192       1      1       1
##  3     2   5169      0     1 56.44627      f     0       0      1       1
##  4     2   5169      0     1 56.44627      f   182       0      1       1
##  5     2   5169      0     1 56.44627      f   365       0      1       1
##  6     2   5169      0     1 56.44627      f   768       0      1       1
##  7     2   5169      0     1 56.44627      f  1790       1      1       1
##  8     2   5169      0     1 56.44627      f  2151       1      1       1
##  9     2   5169      0     1 56.44627      f  2515       1      1       1
## 10     2   5169      0     1 56.44627      f  2882       1      1       1
## # ... with 1,935 more rows, and 9 more variables: edema &lt;dbl&gt;, bili &lt;dbl&gt;,
## #   chol &lt;int&gt;, albumin &lt;dbl&gt;, alk.phos &lt;int&gt;, ast &lt;dbl&gt;, platelet &lt;int&gt;,
## #   protime &lt;dbl&gt;, stage &lt;int&gt;</code></pre>
<ul>
<li>The only tricky task is to correctly manage and prepare the data. Our proposal take advantage of the <code>dplyr</code> functionality</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pbcseq_full &lt;-<span class="st"> </span>pbcseq_df %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(id) %&gt;%<span class="st">                    </span><span class="co"># perform all the next according to the id</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">start  =</span> day,                                 <span class="co"># just to have consistent names</span>
    <span class="dt">end    =</span> <span class="kw">lead</span>(day),           <span class="co"># the end is &quot;the next start&quot; (last will be NA)</span>
    <span class="dt">status =</span> <span class="kw">if_else</span>(<span class="kw">is.na</span>(end), status, 0L), 
    <span class="dt">end    =</span> <span class="kw">if_else</span>(<span class="kw">is.na</span>(end), futime, end) <span class="co"># fill the NA-ends (i.e. the lasts)</span>
                                              <span class="co"># with the real end</span>
)</code></pre></div>
<div id="bilurubine2" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Impact of bilurubine of death</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bil_mod &lt;-<span class="st"> </span><span class="kw">cph</span>(
  <span class="kw">Surv</span>(<span class="dt">time =</span> start, <span class="dt">time2 =</span> end, <span class="dt">event =</span> status ==<span class="st"> </span>2L) ~<span class="st"> </span><span class="kw">log</span>(bili),
  <span class="dt">data =</span> pbcseq_full,
  <span class="dt">x    =</span> <span class="ot">TRUE</span>,
  <span class="dt">y    =</span> <span class="ot">TRUE</span>
)

<span class="kw">summary</span>(bil_mod)</code></pre></div>
<pre><code>##              Effects              Response : Surv(time = start, time2 = end, event = status == 2) 
## 
##  Factor        Low High Diff. Effect S.E.    Lower 0.95 Upper 0.95
##  bili          0.8 3.9  3.1   2.0410 0.13391 1.7786      2.3035   
##   Hazard Ratio 0.8 3.9  3.1   7.6984      NA 5.9213     10.0090</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x   =</span> pbcseq_full$end,
  <span class="dt">y   =</span> <span class="kw">residuals</span>(bil_mod, <span class="dt">type =</span> <span class="st">&#39;dfbeta&#39;</span>),
  <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>
)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="ast_full2" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Impact of ast</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ast_mod &lt;-<span class="st"> </span><span class="kw">cph</span>(
  <span class="kw">Surv</span>(<span class="dt">time =</span> start, <span class="dt">time2 =</span> end, <span class="dt">event =</span> status ==<span class="st"> </span>2L) ~<span class="st"> </span>ast,
  <span class="dt">data =</span> pbcseq_full,
  <span class="dt">x    =</span> <span class="ot">TRUE</span>,
  <span class="dt">y    =</span> <span class="ot">TRUE</span>
)

<span class="kw">summary</span>(ast_mod)</code></pre></div>
<pre><code>##              Effects              Response : Surv(time = start, time2 = end, event = status == 2) 
## 
##  Factor        Low High Diff. Effect S.E.     Lower 0.95 Upper 0.95
##  ast           72  155  83    0.2875 0.044222 0.20083    0.37417   
##   Hazard Ratio 72  155  83    1.3331       NA 1.22240    1.45380</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x   =</span> pbcseq_full$end,
  <span class="dt">y   =</span> <span class="kw">residuals</span>(ast_mod, <span class="dt">type =</span> <span class="st">&#39;dfbeta&#39;</span>),
  <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>
)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(
  <span class="dt">x   =</span> pbcseq_full$end,
  <span class="dt">y   =</span> <span class="kw">residuals</span>(ast_mod, <span class="dt">type =</span> <span class="st">&#39;martingale&#39;</span>),
  <span class="dt">col =</span> <span class="st">&#39;brown&#39;</span>
)</code></pre></div>
<p><img src="SuDACDa-notes_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<p>What happen with the strange observations? We try to find which is that outlier.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># look at the residual caracteristics</span>
<span class="kw">residuals</span>(ast_mod, <span class="dt">type =</span> <span class="st">&#39;martingale&#39;</span>) %&gt;%
<span class="st">  </span>describe</code></pre></div>
<pre><code>## . 
##          n    missing   distinct       Info       Mean        Gmd 
##       1945          0       1855          1 -2.395e-17     0.1868 
##        .05        .10        .25        .50        .75        .90 
##   -0.16941   -0.11177   -0.07449   -0.05021   -0.03303   -0.01672 
##        .95 
##    0.95170 
## 
## lowest : -2.3632251 -0.9104219 -0.7874086 -0.7390614 -0.7120605
## highest:  0.9960346  0.9963091  0.9968442  0.9970148  0.9970895</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># take the id of the lowest</span>
strange_id &lt;-<span class="st"> </span><span class="kw">residuals</span>(ast_mod, <span class="dt">type =</span> <span class="st">&#39;martingale&#39;</span>) %&gt;%
<span class="st">  </span>which.min

<span class="co"># take a look to the ast</span>
pbcseq_full$ast %&gt;%<span class="st"> </span>describe</code></pre></div>
<pre><code>## . 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##     1945        0      418        1    122.7    74.42     41.9     51.2 
##      .25      .50      .75      .90      .95 
##     72.0    107.0    155.0    209.3    250.7 
## 
## lowest :    6.2   21.0   21.7   22.0   23.3, highest:  473.0  655.7  685.1  918.0 1205.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># check the id</span>
pbcseq_full$ast[[strange_id]]</code></pre></div>
<pre><code>## [1] 1205</code></pre>
<p>Here is another example in which the opinion of a clinician is mandatory, i.e. we cannot decide if ignore outliers, which ones, etc</p>
</div>
</div>
<div id="prognostic2" class="section level2">
<h2><span class="header-section-number">2.5</span> Prognostic model</h2>
<div id="prognostic-model-with-ascites-edema-sex-bili-ast-platelet-stage" class="section level3">
<h3><span class="header-section-number">2.5.1</span> prognostic model with <code>àscites</code>, <code>edema</code>, <code>sex</code>, <code>bili</code>, <code>ast</code>, <code>platelet</code>, <code id="model2">stage</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># prepare an ad hoc data frame</span>
pbc_updated &lt;-<span class="st"> </span>pbc_df %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">bili_log     =</span> <span class="kw">log</span>(bili),
    <span class="dt">ast_log      =</span> <span class="kw">log</span>(ast),
    <span class="dt">platelet_ref =</span> platelet_ref, <span class="co"># we have already defined it</span>
    <span class="dt">stage_fct    =</span> <span class="kw">as.factor</span>(stage)
  )

dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(pbc_updated)

<span class="co"># take a look at them </span>
pbc_updated %&gt;%<span class="st"> </span>
<span class="st">  </span>dplyr::<span class="kw">select</span>(
    ascites, edema, sex, bili_log, ast_log, platelet_ref, stage_fct
  ) %&gt;%<span class="st"> </span>
<span class="st">  </span>describe</code></pre></div>
<pre><code>## . 
## 
##  7  Variables      418  Observations
## ---------------------------------------------------------------------------
## ascites 
##        n  missing distinct     Info      Sum     Mean      Gmd 
##      312      106        2    0.213       24  0.07692   0.1425 
## 
## ---------------------------------------------------------------------------
## edema 
##        n  missing distinct     Info     Mean      Gmd 
##      418        0        3    0.391   0.1005   0.1756 
##                             
## Value        0.0   0.5   1.0
## Frequency    354    44    20
## Proportion 0.847 0.105 0.048
## ---------------------------------------------------------------------------
## sex 
##        n  missing distinct 
##      418        0        2 
##                       
## Value          m     f
## Frequency     44   374
## Proportion 0.105 0.895
## ---------------------------------------------------------------------------
## bili_log 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      418        0       98    0.998   0.5715    1.149  -0.6931  -0.5108 
##      .25      .50      .75      .90      .95 
##  -0.2231   0.3365   1.2238   2.0832   2.6391 
## 
## lowest : -1.2039728 -0.9162907 -0.6931472 -0.5108256 -0.3566749
## highest:  3.0726933  3.1135153  3.1986731  3.2386785  3.3322045
## ---------------------------------------------------------------------------
## ast_log 
##        n  missing distinct     Info     Mean      Gmd      .05      .10 
##      312      106      179        1     4.71   0.5075    3.994    4.102 
##      .25      .50      .75      .90      .95 
##    4.389    4.742    5.023    5.280    5.390 
## 
## lowest : 3.271468 3.345685 3.734092 3.770459 3.806662
## highest: 5.662960 5.700945 5.794841 5.823046 6.125230
## ---------------------------------------------------------------------------
## platelet_ref 
##        n  missing distinct 
##      407       11        3 
##                                               
## Value        (150,400]     (0,150] (400,1e+03]
## Frequency          311          61          35
## Proportion       0.764       0.150       0.086
## ---------------------------------------------------------------------------
## stage_fct 
##        n  missing distinct 
##      412        6        4 
##                                   
## Value          1     2     3     4
## Frequency     21    92   155   144
## Proportion 0.051 0.223 0.376 0.350
## ---------------------------------------------------------------------------</code></pre>
<p>There are 11 basic df (one each continuous variable and one-minus-n-level for the categorical one), so to use all of them we need at least <span class="math inline">\(110\)</span> obs. Data has <span class="math inline">\(418\)</span>, this allow us to use a more complex model, with some interaction, splines, etc (more or less other <span class="math inline">\(15 -- 30\)</span> df).</p>
<p>We decide (following suggestions from <span class="citation">Harrell Jr (<a href="#ref-harrell2015regression">2015</a>)</span>) to consider splines for any continuous variable (with 3 knots) and consider sex interaction with them and the other numerical variables, leading to near <span class="math inline">\(20\)</span> df.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_used &lt;-<span class="st"> </span>pbc_updated %&gt;%<span class="st"> </span>
<span class="st">  </span>dplyr::<span class="kw">select</span>(status, time,
    sex, ascites, edema, bili_log, ast_log, platelet_ref, stage_fct
)

dd &lt;-<span class="st"> </span><span class="kw">datadist</span>(data_used)


<span class="co"># all the data-set</span>
<span class="kw">cph</span>(
  <span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~
<span class="st">    </span>sex *<span class="st"> </span>(ascites +<span class="st"> </span>edema +<span class="st"> </span><span class="kw">rcs</span>(bili_log, <span class="dv">3</span>) +<span class="st"> </span><span class="kw">rcs</span>(ast_log, <span class="dv">3</span>)) +
<span class="st">    </span>platelet_ref +<span class="st"> </span>stage_fct,
  <span class="dt">data =</span> data_used
) %&gt;%<span class="st"> </span>
<span class="st">  </span>summary</code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor                               Low      High   Diff.   Effect    
##  ascites                               0.00000 1.0000 1.00000  1.1613000
##   Hazard Ratio                         0.00000 1.0000 1.00000  3.1941000
##  edema                                 0.00000 1.0000 1.00000  0.6370800
##   Hazard Ratio                         0.00000 1.0000 1.00000  1.8910000
##  bili_log                             -0.22314 1.2238 1.44690  1.2273000
##   Hazard Ratio                        -0.22314 1.2238 1.44690  3.4120000
##  ast_log                               4.38950 5.0232 0.63372  0.3791100
##   Hazard Ratio                         4.38950 5.0232 0.63372  1.4610000
##  sex - m:f                             2.00000 1.0000      NA  2.0211000
##   Hazard Ratio                         2.00000 1.0000      NA  7.5463000
##  platelet_ref - (0,150]:(150,400]      1.00000 2.0000      NA  0.0907330
##   Hazard Ratio                         1.00000 2.0000      NA  1.0950000
##  platelet_ref - (400,1e+03]:(150,400]  1.00000 3.0000      NA  0.0059127
##   Hazard Ratio                         1.00000 3.0000      NA  1.0059000
##  stage_fct - 1:3                       3.00000 1.0000      NA -1.2551000
##   Hazard Ratio                         3.00000 1.0000      NA  0.2850400
##  stage_fct - 2:3                       3.00000 2.0000      NA -0.3858200
##   Hazard Ratio                         3.00000 2.0000      NA  0.6798900
##  stage_fct - 4:3                       3.00000 4.0000      NA  0.6523900
##   Hazard Ratio                         3.00000 4.0000      NA  1.9201000
##  S.E.    Lower 0.95 Upper 0.95
##  0.31762  0.538770   1.78380  
##       NA  1.713900   5.95260  
##  0.35904 -0.066626   1.34080  
##       NA  0.935550   3.82200  
##  0.28103  0.676490   1.77810  
##       NA  1.967000   5.91870  
##  0.18497  0.016587   0.74164  
##       NA  1.016700   2.09940  
##  0.54588  0.951150   3.09100  
##       NA  2.588700  21.99800  
##  0.25377 -0.406650   0.58812  
##       NA  0.665870   1.80060  
##  0.35526 -0.690380   0.70221  
##       NA  0.501380   2.01820  
##  1.03160 -3.277100   0.76682  
##       NA  0.037739   2.15290  
##  0.30581 -0.985210   0.21356  
##       NA  0.373360   1.23810  
##  0.23174  0.198190   1.10660  
##       NA  1.219200   3.02400  
## 
## Adjusted to: sex=f ascites=0 edema=0.5 bili_log=0.3364722 ast_log=4.74232</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># without missing data, and with beckward stepwise variable selection</span>
<span class="kw">cph</span>(
  <span class="kw">Surv</span>(time, status ==<span class="st"> </span><span class="dv">2</span>) ~
<span class="st">    </span>sex +<span class="st"> </span>ascites +<span class="st"> </span>edema +<span class="st"> </span>bili_log +<span class="st"> </span>ast_log +<span class="st"> </span>platelet_ref +<span class="st"> </span>stage_fct,
  <span class="dt">data =</span> pbc_updated %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))
) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">step</span>(<span class="dt">trace =</span> <span class="dv">0</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span>summary</code></pre></div>
<pre><code>##              Effects              Response : Surv(time, status == 2) 
## 
##  Factor          Low      High   Diff.  Effect   S.E.    Lower 0.95
##  ascites          0.00000 1.0000 1.0000  0.62140 0.33765 -0.040376 
##   Hazard Ratio    0.00000 1.0000 1.0000  1.86150      NA  0.960430 
##  edema            0.00000 1.0000 1.0000  1.18730 0.33082  0.538900 
##   Hazard Ratio    0.00000 1.0000 1.0000  3.27820      NA  1.714100 
##  bili_log        -0.22314 1.2238 1.4469  1.24480 0.15866  0.933880 
##   Hazard Ratio   -0.22314 1.2238 1.4469  3.47240      NA  2.544400 
##  sex - m:f        2.00000 1.0000     NA  0.52890 0.25407  0.030938 
##   Hazard Ratio    2.00000 1.0000     NA  1.69710      NA  1.031400 
##  stage_fct - 1:3  3.00000 1.0000     NA -1.48070 1.01500 -3.470100 
##   Hazard Ratio    3.00000 1.0000     NA  0.22748      NA  0.031115 
##  stage_fct - 2:3  3.00000 2.0000     NA -0.29414 0.31748 -0.916400 
##   Hazard Ratio    3.00000 2.0000     NA  0.74517      NA  0.399960 
##  stage_fct - 4:3  3.00000 4.0000     NA  0.53395 0.22987  0.083422 
##   Hazard Ratio    3.00000 4.0000     NA  1.70570      NA  1.087000 
##  Upper 0.95
##  1.28320   
##  3.60810   
##  1.83570   
##  6.26950   
##  1.55580   
##  4.73890   
##  1.02690   
##  2.79230   
##  0.50872   
##  1.66320   
##  0.32812   
##  1.38840   
##  0.98449   
##  2.67640</code></pre>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-harrell2015regression">
<p>Harrell Jr, Frank E. 2015. <em>Regression Modeling Strategies: With Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis</em>. Springer.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>In reality this is not really true because who stay better is on the top of the list!<a href="cox.html#fnref2">↩</a></p></li>
<li id="fn3"><p>As suggested by <em>couthcommander</em> in <a href="https://github.com/CorradoLanera/SuDACDa/issues/2" class="uri">https://github.com/CorradoLanera/SuDACDa/issues/2</a>.<a href="cox.html#fnref3">↩</a></p></li>
<li id="fn4"><p>Good example in which only the clinicians know if it is an effect clinically relevant (deciding it <strong>before</strong> the analyses) or not<a href="cox.html#fnref4">↩</a></p></li>
<li id="fn5"><p>The answer here should be “if there are no marginal significant effect is has no sense to look at the interaction terms!”.<a href="cox.html#fnref5">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="survival.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="competing-risk.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["SuDACDa-notes.epub", "SuDACDa-notes.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
